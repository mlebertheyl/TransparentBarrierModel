"0","corr.from.Q.simplified <- function( #I am calculating A.tmp and all outside"
"0","    Q = Q,"
"0","    id.node = id.node.n,"
"0","    id.coord = id.coord.n,"
"0","    in.id.node = id.node.b) { "
"0","  "
"0","  sd <- sqrt(diag(inla.qinv(Q)))"
"0",""
"0",""
"0","  Inode = rep(0, dim(Q)[1]) "
"0","  Inode[id.node] = 1"
"0","  covar.column = solve(Q, Inode)"
"0","# compute correlations"
"0","  corr = drop(matrix(covar.column)) / (sd*sd[id.node])"
"0","  corr2points <- corr[in.id.node]"
"0","  "
"0","  return(corr2points)"
"0","}"

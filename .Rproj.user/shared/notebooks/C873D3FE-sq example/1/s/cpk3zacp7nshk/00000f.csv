"0","#### Simulate response variable for loc.data"
"0","r_nbT <- 4"
"0","r_bT <- c(0.5)"
"0","df.T <- trans.generate.q2(mesh = mesh, fem = fem, "
"0","                        loc.data = loc.data, "
"0","                        set.inla.seed = 2303, "
"0","                        barrier.triangles = barrier.triangles, "
"0","                        prior.range = c(1, 0.5), prior.sigma = c(1, 0.1),"
"0","                        range.fraction = c(r_bT[1]), "
"0","                        range = r_nbT,"
"0","                        sigma.u = 1, sigma.epsilon = 0.2,"
"0","                        return.list = TRUE)"
"0",""
"0",""
"0","df <- df.T$list.field$df"
"0","A.data <- df.T$list.field$A.data"
"0",""
"0","#### Stationary model"
"0","prior.range.st = c(1, 0.5)"
"0","prior.sigma.st = c(1, 0.1)"
"0",""
"0","stk <- inla.stack(data=list(y=df$y), "
"0","                    A=list(A.data, 1),"
"0","                    effects=list(s=1:mesh$n, "
"0","                                 intercept=rep(1, nrow(df))), "
"0","                    remove.unused = FALSE, "
"0","                    tag='est')"
"0"," "
"0","model.stat <- inla.spde2.pcmatern(mesh, "
"0","                                  prior.range = "
"0","                                    c(prior.range.st[1],"
"0","                                      prior.range.st[2]),"
"0","                                  prior.sigma = "
"0","                                    c(prior.sigma.st[1],"
"0","                                      prior.sigma.st[2]))"
"0","  "
"0","formula.st <- y ~ 0 + intercept + f(s, model=model.stat)"
"0","  "
"0","res.stationary <- inla(formula.st, data=inla.stack.data(stk),"
"0","            control.predictor=list(A = inla.stack.A(stk)),"
"0","            family = 'gaussian',"
"0","            control.family = list(hyper = list(prec = list("
"0","              prior = ""pc.prec"", fixed = FALSE, "
"0","              param = c(0.2,0.5)))),"
"0","            control.mode=list(restart=T, theta=c(4,-1.7,0.25)))"
"0","  "
"0","#### Transparent Barrier model with reference correlation not 1"
"0","## range fraction optim line 507"
"0",""
"0","x <- 0.4792988"
"0","barrier.model <- inla.barrier.pcmatern.plus(mesh, "
"0","                             fem, "
"0","                             barrier.triangles, "
"0","                             prior.range = c(1, 0.5),"
"0","                             prior.sigma = c(1, 0.1),"
"0","                             range.fraction = c(x[1]))"
"0",""
"0","formula <- y ~ 0 + intercept + f(s, model = barrier.model)"
"0",""
"0","res.barrier <- inla(formula, "
"0","                    data = inla.stack.data(stk),"
"0","                    control.predictor = "
"0","                      list(A = inla.stack.A(stk)),"
"0","                    family = 'gaussian',"
"0","                    control.family = "
"0","                      list(hyper = list("
"0","                          prec = list(prior = ""pc.prec"", "
"0","                                      fixed = FALSE, "
"0","                                      param = c(0.2,0.5)))),"
"0","                    control.mode=list(restart=T, "
"0","                                      theta=c(3.2, 0.4, 1.6)))"
"2","Loading required package: Matrix
"
"2","Loading required package: sp
"
"2","This is INLA_23.06.29 built 2023-06-30 04:44:50 UTC.
 - See www.r-inla.org/contact-us for how to get help.
"
"0","res.stationary$summary.hyperpar"

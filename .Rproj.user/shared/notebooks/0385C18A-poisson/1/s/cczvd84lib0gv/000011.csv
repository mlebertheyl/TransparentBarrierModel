"0",""
"0","A.y.vector <- c(mesh$loc[id.nodeA[[1]],][2],"
"0","                  mesh$loc[id.nodeA[[2]],][2],"
"0","                  mesh$loc[id.nodeA[[3]],][2])"
"0",""
"0","A.tmp <- A[[which(A.y.vector > y.up)[1]]]"
"0","id.node <- id.nodeA[which(A.y.vector > y.up)[1]]"
"0","id.coord <- c(mesh$loc[id.node, 1], mesh$loc[id.node, 2])"
"0","return.list.up <- list(A.tmp = A.tmp, id.coord = id.coord, id.node = id.node)"
"0",""
"0","## lower point, i.e. point in barrier area"
"0","A <- list()"
"0","A[[1]] <- inla.spde.make.A(mesh=mesh,"
"0","                     loc = matrix(c(location[2,1],y.up), nrow=1, ncol=2))"
"0","A[[2]] <- inla.spde.make.A(mesh=mesh,"
"0","                     loc = matrix(c(location[2,1],(y.up - max.edge.length/2)), nrow=1, ncol=2))"
"0","A[[3]] <- inla.spde.make.A(mesh=mesh,"
"0","                     loc = matrix(c(location[2,1],(y.up - max.edge.length)), nrow=1, ncol=2))"
"0","id.nodeA <- c()"
"0","id.nodeA[1] = which.max(A[[1]][1, ])"
"0","id.nodeA[2] = which.max(A[[2]][1, ])"
"0","id.nodeA[3] = which.max(A[[3]][1, ])"
"0",""
"0","A.y.vector <- c(mesh$loc[id.nodeA[[1]],][2],"
"0","                  mesh$loc[id.nodeA[[2]],][2],"
"0","                  mesh$loc[id.nodeA[[3]],][2])"
"0",""
"0","A.tmp <- A[[which(A.y.vector < y.up)[1]]]"
"0","id.node <- id.nodeA[which(A.y.vector < y.up)[1]]"
"0","id.coord <- c(mesh$loc[id.node, 1], mesh$loc[id.node, 2])"
"0",""
"0","return.list.low <- list(A.tmp = A.tmp, id.coord = id.coord, id.node = id.node)"
"0",""
"0","return.list <- list(normal.point = return.list.up, barrier.point = return.list.low)"
"0",""
"0","coord.df_norm <- return.list$normal.point$id.coord"
"0","coord.df_bar <- return.list$barrier.point$id.coord"
"0",""
"0","points_nb <- rbind(coord.df_norm, coord.df_bar)"
"0","rownames(points_nb) <- NULL"
"0","colnames(points_nb) <- c(""x"", ""y"")"
"0","points_nb <- as.matrix(points_nb)"
"0","poly_nb <- Polygon(points_nb)"
"2","Warning: less than 4 coordinates in polygon"
"0","SpatialPoints(poly_nb@coords)"
"1","SpatialPoints:
"
"1","    "
"1","        x"
"1","        y"
"1","
[1,]"
"1"," 6.360238"
"1"," 6.209672"
"1","
[2,]"
"1"," 6.476326"
"1"," 5.782254"
"1","
[3,]"
"1"," 6.360238"
"1"," 6.209672"
"1","
[4,]"
"1"," 6.360238"
"1"," 6.209672"
"1","
"
"1","Coordinate Reference System (CRS) arguments: NA"
"1"," "
"1","
"
"0","sp_points_nb <- SpatialPoints(poly_nb@coords)"
"0","sf_points_nb <- st_as_sf(sp_points_nb)"
"0",""
"0","ggplot(data = pf$poly.water_sf) + "
"0","      inlabru::gg(pf$mesh) + #plot mesh_hb alternatively"
"0","      geom_sf(data =sf_points_nb,"
"0","          col='purple',size=1.7,alpha=0.5) "
